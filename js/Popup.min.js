!function(a){function c(b){var c={},d=a(b).find("[data-popup-settings]").add(a(b).filter("[data-popup-settings]")).eq(0),e=d.data("popup-settings");void 0!==e&&null!==e&&(c={binding:e.binding,type:e.type,withTimeout:e.timeout,withBackground:e.background,withFade:e.fade});var f={binding:a.fn.popup.binding,type:a.fn.popup.type,withTimeout:a.fn.popup.withTimeout,withBackground:a.fn.popup.withBackground,withFade:a.fn.popup.withFade};return c=a.extend(c,f),c=a.extend({binding:"on",type:"obedient",withTimeout:!1,withBackground:!1,withFade:!1},c),d.removeAttr("data-popup-settings"),delete a.fn.popup.binding,delete a.fn.popup.type,delete a.fn.popup.withTimeout,delete a.fn.popup.withBackground,delete a.fn.popup.withFade,c}function d(b,c){var d={},e=a(b).find("[data-popup-extra]").add(a(b).filter("[data-popup-extra]")).eq(0),f=a(".popupContent",b),g=e.data("popup-extra");void 0!==g&&null!==g&&(d={id:g.id,position:g.position,parent:void 0!==g.parentid?a("#"+g.parentid):void 0,distanceOffset:g.distanceOffset,alignOffset:g.alignOffset,invertDock:g.invertDock});var h={id:a.fn.popup.id,position:a.fn.popup.position,parent:void 0!==c?a(c):void 0,distanceOffset:a.fn.popup.distanceOffset,alignOffset:a.fn.popup.alignOffset,invertDock:a.fn.popup.invertDock};return d=a.extend(d,h),d=a.extend({id:"pp_"+Math.floor(1e5*Math.random()),content:0==f.length?a("<div class='popupContent'></div>").html(b):f,position:"user",parent:a(document.body),distanceOffset:0,alignOffset:0,invertDock:"none"},d),e.removeAttr("data-popup-extra"),delete a.fn.popup.id,delete a.fn.popup.position,delete a.fn.popup.distanceOffset,delete a.fn.popup.alignOffset,delete a.fn.popup.invertDock,d}function e(b,c){a(".uiPopup").each(function(){})}function f(b,c,d){var e=a(this),f=a("<div class='uiPopup elevated' />");f.data("popup-settings",b),f.data("popup-extra",c),f.append(a("<div class='ppArrowBack'></div>")),f.append(c.content),f.append(a("<div class='ppArrowFront'></div>")),f.attr("id",c.id),b.withBackground&&c.parent.append("<div class='popupOverlay' />"),g.call(f),o(f),b.withBackground&&f.detach().appendTo(c.parent.children(".popupOverlay")),!b.withBackground&&b.type.match(/obedient/gi)&&(c.parentContainer=c.parent.is(a(document.body))?a(document):c.parent,c.parentContainer.off("click.popup"),c.parentContainer.on("click.popup",function(b){var c=a(a(this).is(a(document))?document.body:this),d=c.find(".uiPopup").not(".elevated").filter(function(){var b=a(this).data("popup-settings");return b&&b.type&&"persistent"!=b.type});0!=d.length&&0==a(b.target).closest(d).length&&d.trigger("dispose")})),setTimeout(function(){a(".uiPopup.elevated").removeClass("elevated")},200),b.withBackground&&(f.addClass("wbg"),c.parent.off("click",".popupOverlay"),c.parent.on("click",".popupOverlay",function(b){a(b.target).hasClass("popupOverlay")&&(c.parent.off("click",".popupOverlay"),a(this).children(".uiPopup").filter(function(){var b=a(this).data("popup-settings");return b&&b.type&&"persistent"!=b.type}).trigger("dispose"))})),e.data("popup",f),e.off("dispose.popup"),e.one("dispose.popup",function(b){b.stopPropagation();var c=a(this).data("popup");void 0!==c&&(clearTimeout(c.data("disposalTimer")),c.trigger("dispose"))}),f.data("popup-extra",c),a(document).off("keydown.popup"),a(document).on("keydown.popup",function(b){27==b.which&&a(".uiPopup").trigger("dispose")}),"function"==typeof d&&d.call(f.get(0)),f.on("reposition",function(){s(f)})}function g(){var b=a(this),c=b.data("popup-settings");b.css({position:"fixed",top:"",left:"",bottom:"",right:""}),b.on("dispose.popup",function(b){a(this).trigger("cancel"),l(a(this))}),b.on("click.close.popup",".actionButton",function(){a(this).closest(".uiNotification").hasClass("uiPopup")&&h(b)}),c.withTimeout&&(j.call(b.get(0)),b.on({"mouseenter.popup":function(){b.find(".actionButton").empty(),b.removeClass("timeout"),clearTimeout(b.data("disposalTimer"))},"mouseleave.popup":function(){j.call(b.get(0))}})),b.appendTo(b.data("popup-extra").parent)}function h(a){a.trigger("dispose")}function i(a){a.data("popup-settings").withFade=!0,h(a)}function j(){var b=a(this);b.addClass("timeout"),b.data("disposalTimer",setTimeout(function(){i(b)},3e3))}function k(b){var c=b.data("popup-settings"),d=b.data("popup-extra");c.withFade?a(".popupOverlay",d.parent).fadeOut(200,function(){a(this).remove()}):a(".popupOverlay",d.parent).css("display","").remove(),d.parent.removeClass("popupFixedParent")}function l(b){var c=b.data("popup-settings"),d=b.data("popup-extra"),e=b.data("popup-extra").sender;clearTimeout(b.data("disposalTimer")),b.off(".popup"),e.removeData("popup"),"one"==c.binding&&e.off(".popup"),c.withBackground&&k(b),c.withFade?b.fadeOut(200,function(){a(this).remove()}):b.remove(),e.off(".popup"),d.parent.off(".popup"),a(document.body).off(".popup"),a(document).off(".popup"),a(window).off(".popup")}function m(b){var c=b.data("popup-settings"),d=b.data("popup-extra");c.withFade?a(".popupOverlay",d.parent).fadeIn(200):a(".popupOverlay",d.parent).css("display","block")}function n(a){var b=a.data("popup-settings"),c=a.data("popup-extra");b.withFade?a.fadeIn(200):a.css("display","block"),b.withBackground&&m(a);var d=a.children(".ppArrowBack");if(0!=d.length){var i,j,k,e=a.children(".ppArrowFront"),f=8,g=2,h=c.sender;"center"==c.pointer.alignment||("left"==c.pointer.alignment||"right"==c.pointer.alignment)&&h.outerWidth()>a.outerWidth()||("top"==c.pointer.alignment||"bottom"==c.pointer.alignment)&&h.outerHeight()>a.outerHeight()?a.addClass(c.pointer.orientation+"centerPointer"):"left"==c.pointer.alignment||"right"==c.pointer.alignment?(i=h.offset().left-a.offset().left-g+h.outerWidth()/2-f,k="left",j=i>=0&&i<=a.width()):(i=h.offset().top-a.offset().top-g+h.outerHeight()/2-f,k="top",j=i>=0&&i<=a.height()),void 0!==i&&j&&(a.addClass(c.pointer.orientation+"Pointer"),d.css(k,i),e.css(k,i+1))}}function o(b){var c=b.data("popup-extra");if("object"==a.type(c.position))return void p(b);var d=c.position.split("|");1==d.length?q(b):r(b)}function p(b){var c=b.data("popup-extra");b.css({top:"",bottom:"",left:"",right:"",position:"absolute","margin-left":"","margin-right":"","margin-top":"","margin-bottom":""}),b.data("popup-extra").calculatedPosition=a.extend({top:"",bottom:"",left:"",right:"",position:"absolute"},c.position),s(b)}function q(b){var c=b.data("popup-extra"),d=b.data("popup-settings"),e=["left:0%|bottom:0%","bottom","right:0%|bottom:0%","left","center","right","left:0%|top:0%","top","right:0%|top:0%"],f="fixed";d.withBackground&&(f="absolute"),b.css({top:"",bottom:"",left:"",right:"",position:f,"margin-left":"","margin-right":"","margin-top":"","margin-bottom":""}),c.calculatedPosition=a.trim(c.position);var g=parseInt(c.calculatedPosition);"user"==c.calculatedPosition?c.calculatedPosition="top:15%|center":g>0&&g<10?c.calculatedPosition=e[g-1]:"top"!=c.calculatedPosition&&"bottom"!=c.calculatedPosition&&"left"!=c.calculatedPosition&&"right"!=c.calculatedPosition&&(c.calculatedPosition="center"),b.data("popup-extra").calculatedPosition=c.calculatedPosition,s(b)}function r(b){b.css({top:"",bottom:"",left:"",right:"",position:"absolute","margin-left":"","margin-right":"","margin-top":"","margin-bottom":""}),b.addClass("wbrdr");var c=b.data("popup-extra").position,d=c.split("|");d[0]=a.trim(d[0]),b.data("popup-extra").pointer={},"top"==d[0]||"bottom"==d[0]?u(b,c,0):"left"==d[0]||"right"==d[0]?v(b,c,0):(b.data("popup-extra").calculatedPosition="center",s(b))}function s(b){var c=b.height(),d=b.width(),g=(a(window).width(),a(window).height(),b.data("popup-extra"));if(b.children(".ppArrowBack, .ppArrowFront").remove(),"object"==a.type(g.calculatedPosition)){for(var h in g.calculatedPosition)"center"!=g.calculatedPosition[h]||"top"!=h&&"bottom"!=h?"center"!=g.calculatedPosition[h]||"left"!=h&&"right"!=h||(g.calculatedPosition[h]="50%",b.css("margin-"+h,"-"+d/2+"px")):(g.calculatedPosition[h]="50%",b.css("margin-"+h,"-"+c/2+"px"));return b.css(g.calculatedPosition),void n(b)}var i=g.calculatedPosition.split("|");if(1==i.length){var j="top"==a.trim(g.calculatedPosition)?0:"50%",k="left"==a.trim(g.calculatedPosition)?0:"50%",l="bottom"==a.trim(g.calculatedPosition)?(j="",l=0):"",m="right"==a.trim(g.calculatedPosition)?(k="",m=0):"";"50%"==j&&b.css("margin-top","-"+c/2+"px"),"50%"==k&&b.css("margin-left","-"+d/2+"px"),b.css({top:j,left:k,bottom:l,right:m})}else{var o=i[0].split(":"),p=i[1].split(":");if("center"==a.trim(o[0])){var j="50%";b.css("margin-top","-"+c/2+"px"),o[0]="top",o[1]=j}if("center"==a.trim(p[0])){var k="50%";b.css("margin-left","-"+d/2+"px"),p[0]="left",p[1]=k}b.css(o[0],o[1]).css(p[0],p[1])}n(b)}function t(a){var d=(a.height(),a.width(),a.data("popup-extra")),g=(d.sender,d.senderOffset,d.calculatedPosition.split("|")),h=g[0].split(":"),i=g[1].split(":");a.css({position:"absolute"}),a.css(h[0],parseInt(h[1])),a.css(i[0],parseInt(i[1])),n(a)}function u(b,c,d){var h,e=b.data("popup-extra"),f=c.split("|"),g=e.distanceOffset+10,i=e.sender,j=e.senderOffset,k=e.invertedVerticalDock===!0?"bottom":"top",l={top:"bottom",bottom:"top"};f[0]=a.trim(f[0]),b.data("popup-extra").pointer.orientation=l[f[0]],h="top"==f[0]?e.invertedVerticalDock===!0?e.parent.height()-j.top+g:j.top-g-b.outerHeight():e.invertedVerticalDock===!0?e.parent.height()-j.top-i.outerHeight()-b.outerHeight()-g:j.top+i.outerHeight()+g;var m=w(b,e.parent.offset().top+h,e.parent)||e.parent.is(a(document.body)),n=x(b,e.parent.offset().top+h);m&&n||d>1?(b.data("popup-extra").calculatedPosition=k+":"+h+"|",A(b,f[1],0)):u(b,l[f[0]]+"|"+f[1],++d)}function v(b,c,d){var h,e=b.data("popup-extra"),f=c.split("|"),g=e.distanceOffset+10,i=e.sender,j=e.senderOffset,k=e.invertedHorizontalDock===!0?"right":"left",l={left:"right",right:"left"};f[0]=a.trim(f[0]),b.data("popup-extra").pointer.orientation=l[f[0]],h="left"==f[0]?e.invertedHorizontalDock===!0?e.parent.width()-j.left+g:j.left-g-b.outerWidth():e.invertedHorizontalDock===!0?e.parent.width()-j.left-i.outerWidth()-b.outerWidth()-g:j.left+i.outerWidth()+g;var m=y(b,e.parent.offset().left+h,e.parent)||e.parent.is(a(document.body)),n=z(b,e.parent.offset().left+h);m&&n||d>1?(b.data("popup-extra").calculatedPosition=k+":"+h+"|",B(b,f[1],0)):v(b,l[f[0]]+"|"+f[1],++d)}function w(a,b,c){var d=c.offset().top;return!(d>b||d+c.height()<b+a.outerHeight())}function x(b,c){var d=a(document).scrollTop();return!(d>c||d+a(window).height()<c+b.height())}function y(a,b,c){var d=c.offset().left;return!(d>b||d+c.width()<b+a.outerWidth())}function z(b,c){var d=a(document).scrollLeft();return!(d>c||d+a(window).width()<c+b.width())}function A(b,c,d){var h,e=b.data("popup-extra"),f=e.senderOffset,g=e.alignOffset,i=e.sender,k=e.invertedHorizontalDock===!0?"right":"left",l={left:"right",right:"left",center:"right"};b.data("popup-extra").pointer.alignment=a.trim(c);var m=1;switch(a.trim(c)){case"left":h=e.invertedHorizontalDock===!0?e.parent.width()-f.left-b.outerWidth()+m:f.left-m;break;case"right":h=e.invertedHorizontalDock===!0?e.parent.width()-f.left-i.outerWidth()-m:f.left+i.outerWidth()-b.outerWidth()+m;break;case"center":h=e.invertedHorizontalDock===!0?e.parent.width()-f.left-i.outerWidth()-(b.outerWidth()-i.outerWidth())/2:f.left-(b.outerWidth()-i.outerWidth())/2;break;default:return b.data("popup-extra").calculatedPosition="center",void s(b)}var n=y(b,e.parent.offset().left+h,e.parent)||e.parent.is(a(document.body)),o=z(b,e.parent.offset().left+h);n&&o||d>1?(b.data("popup-extra").calculatedPosition+=k+":"+(h+g),t(b)):A(b,l[c],++d)}function B(b,c,d){var h,e=b.data("popup-extra"),f=e.senderOffset,g=e.alignOffset,i=e.sender,k=e.invertedVerticalDock===!0?"bottom":"top",l={top:"bottom",bottom:"top",center:"bottom"};b.data("popup-extra").pointer.alignment=a.trim(c);var m=1;switch(a.trim(c)){case"top":h=e.invertedVerticalDock===!0?e.parent.height()-f.top-b.outerHeight()+m:f.top-m;break;case"bottom":h=e.invertedVerticalDock===!0?e.parent.height()-f.top-i.outerHeight()-m:f.top+i.outerHeight()-b.outerHeight()+m;break;case"center":h=e.invertedVerticalDock===!0?e.parent.height()-f.top-i.outerHeight()-(b.outerHeight()-i.outerHeight())/2:f.top-(b.outerHeight()-i.outerHeight())/2;break;default:return b.data("popup-extra").calculatedPosition="center",void s(b)}var n=w(b,e.parent.offset().top+h,e.parent)||e.parent.is(a(document.body)),o=x(b,e.parent.offset().top+h);n&&o||d>1?(b.data("popup-extra").calculatedPosition+=k+":"+(h+g),t(b)):B(b,l[c],++d)}var b={init:function(a,b,c){return this.each(function(){f.call(this,a,b,c)})},exists:function(){return!(void 0===a(this).data("popup"))}};a(document).on("wheel mousewheel DOMMouseScroll scroll",".popupOverlay",function(a){a.stopPropagation()}),a.fn.popup=function(f,g,h){var i=a(this);if("exists"==f)return b.exists.call(i);if("set"==f)return b.set.call(i,a(g));settings=c(f),extra=d(f,g),extra.sender=i,extra.invertedHorizontalDock="horizontal"==extra.invertDock||"both"==extra.invertDock,extra.invertedVerticalDock="vertical"==extra.invertDock||"both"==extra.invertDock;var j=extra.parent.is(a(document.body))?i.offset():{top:i.offset().top-a(extra.parent).offset().top,left:i.offset().left-a(extra.parent).offset().left};extra.senderOffset=j,extra.calculatedPosition=extra.position;var k=a();return a(".uiPopup").each(function(){var b=a(this),c=b.data("popup-extra");c&&c.sender.is(i)&&settings.type.match(/toggle/gi)&&(k=k.add(b))}),k.length>0?void k.trigger("dispose"):(e(i,extra.parent),b.init.call(i,settings,extra,h))},a.event.special.destroyed={remove:function(a){a.handler&&a.handler()}}}(jQuery);